<?xml version="1.0"?>

<!DOCTYPE workflow [

<!ENTITY STARTYEAR "2024">
<!ENTITY STARTMONTH "06">
<!ENTITY STARTDAY "20">
<!ENTITY STARTHOUR "06">

<!ENTITY ENDYEAR "2024">
<!ENTITY ENDMONTH "06">
<!ENTITY ENDDAY "20">
<!ENTITY ENDHOUR "06">

<!ENTITY USER "Matthew.Pyle">
<!ENTITY ACCOUNT "NAM-DEV">
<!ENTITY ACCOUNT2 "NAM-DEV">
<!ENTITY QUEUE_NOSHARE "dev">
<!ENTITY QUEUE_PRDGEN "dev">
<!ENTITY QUEUE "dev">
<!ENTITY QUEUE_FORECAST "dev">

<!ENTITY ENVIR "para">
<!ENTITY NAM_VER "v4.2.9">
<!ENTITY NET "nam">
<!ENTITY RUN "nam">
<!ENTITY NWROOT "/lfs/h2/emc/lam/noscrub/Matthew.Pyle">
<!ENTITY PACKAGEROOT "/lfs/h2/emc/lam/noscrub/Matthew.Pyle">
<!ENTITY HOMEnam "/lfs/h2/emc/lam/noscrub/Matthew.Pyle/nam.v4.2.9">
<!ENTITY USHnam "/lfs/h2/emc/lam/noscrub/Matthew.Pyle/nam.v4.2.9/ush">
<!ENTITY JOBSnam "/lfs/h2/emc/lam/noscrub/Matthew.Pyle/nam.v4.2.9/jobs">
<!ENTITY HOMEjobs "/lfs/h2/emc/lam/noscrub/Matthew.Pyle/nam.v4.2.9/jobs">
<!ENTITY COMDATEROOT "/lfs/h1/ops/prod/com">
<!ENTITY GESIN "/lfs/h2/emc/ptmp/Matthew.Pyle/para/com/nam/v4.2/nwges">
<!ENTITY COMOUTbase "/lfs/h2/emc/ptmp/Matthew.Pyle/para/com/nam/v4.2">
<!ENTITY COMOUTnco "/lfs/h1/ops/prod/com/nam/v4.2/nam">
<!ENTITY COM_PREPBUFR "/lfs/h1/ops/prod/com/obsproc/v1.0"> <!-- Only relevant for real time runs -->
<!ENTITY COM_PREPBUFR_TM00 "/lfs/h1/ops/prod/com/obsproc/v1.0"> <!-- Only relevant for real time runs -->
<!ENTITY COMINrap "/lfs/h1/ops/prod/com/rap/v5.1">
<!ENTITY COMNAM "/lfs/h2/emc/ptmp/Matthew.Pyle/para/com/nam/v4.2">
<!ENTITY LOG_DIR "/lfs/h2/emc/ptmp/Matthew.Pyle/output_para"> <!-- Where all job stdout/stderr goes -->
<!ENTITY JLOGFILE "/lfs/h2/emc/ptmp/Matthew.Pyle/output_para/jlogfile">
<!ENTITY DATAROOT "/lfs/h2/emc/stmp/Matthew.Pyle/tmp"> <!-- Where all tasks run to specify -->
<!--  *****************************Forecast Lengths*********************************  -->
<!ENTITY FMAX_CATCHUP_PARENT "84">
<!ENTITY CATCHUP_PARENT_FHR_LIST "00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84">
<!ENTITY CATCHUP_PARENT_FHR07_to_FMAX "07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84">
<!ENTITY CATCHUP_PARENT_PRDGEN_TIMES "00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 39 42 45 48 51 54 57 60 63 66 69 72 75 78 81 84">
<!ENTITY CATCHUP_PARENT_PCP_TIMES "01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 39 42 45 48 51 54 57 60 63 66 69 72 75 78 81 84">
<!ENTITY CATCHUP_PARENT_AWIPS_TIMES "00 03 06 09 12 15 18 21 24 27 30 33 36 39 42 45 48 51 54 57 60 63 66 69 72 75 78 81 84">

<!ENTITY FMAX_CATCHUP_NEST "60">
<!ENTITY CATCHUP_NEST_FHR_LIST "00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
<!ENTITY CATCHUP_NEST_FHR07_to_FMAX "07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
<!ENTITY CATCHUP_NEST_FHR07_to_FMAX_Firewx "07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36">
<!ENTITY CATCHUP_NEST_PRDGEN_TIMES "00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
<!ENTITY CATCHUP_NEST_PRDGEN_TIMES_Firewx "00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36">
<!ENTITY CATCHUP_NEST_PCP_TIMES "01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
<!ENTITY CATCHUP_NEST_PCP_TIMES_Firewx "01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36">

<!--  **********************************************************************************  -->



<!-- ************************************************************************************************************  -->

<!-- NOTE THAT MEMORY FOR SHARED JOBS IS INTERPRETED AS PER-PROCESS -->

<!-- This is what gets passed through to PBS/LSF - BE CAREFUL TO USE THE APPROPRIATE SYNTAX -->
<!ENTITY RESERVATION_NOSHARE '<queue>&QUEUE_NOSHARE;</queue><account>&ACCOUNT;</account>'>
<!ENTITY RESERVATION '<queue>&QUEUE;</queue><account>&ACCOUNT;</account>'>  
<!ENTITY RESERVATION_PRDGEN '<queue>&QUEUE_PRDGEN;</queue><account>&ACCOUNT;</account>'>  
<!ENTITY RESERVATION_AWIPS '<queue>&QUEUE_PRDGEN;</queue><account>&ACCOUNT;</account>'>  
<!ENTITY RESERVATION_CATCHUP_FORECAST '<queue>&QUEUE_FORECAST;</queue><account>&ACCOUNT;</account>'>
<!ENTITY RESERVATION_HOURLY_FORECAST '<queue>&QUEUE_FORECAST;</queue><account>&ACCOUNT2;</account>'>

<!-- Start time offsets for real time runs.  Offsets only work in the positive time direction! -->
<!-- This means that for Catchup cycle defs, we have to offset things a bit, i.e. the 12Z cycle actually starts -->
<!-- at 03Z, and so on.  We then must offset the cycle date and times exported to the J-jobs -->
<!-- Format is dd:hh:mm:ss -->

 

<!ENTITY START_TIME_HOURLY "00:00:00">  <!-- Real time for the hourly bit - let's try beginning with no delayed start -->
                                        <!-- since several of the beginning pieces are just boco file processing -->
<!ENTITY MAX_DELAY_HOURLY "03:30:00">   <!-- Maximum time allowed to wait for an f01 background file before telling the -->
                                        <!-- Hourly cycle to grab the best available restart file -->
<!ENTITY START_TIME_HOURLY_ANALYSIS "00:40:00">  <!-- Make sure obs are ready - have this be an <or> dependency with prepbufr data -->


<!ENTITY DEADLINE_HOURLY "15:00:00">  <!-- Establishing some completion offset deadlines is probably a good idea -->
<!ENTITY DEADLINE_CATCHUP "15:00:00">

<!-- This job basically controls the earliest the rest can start -->
<!-- Remaining times may be irrelevant based on the TM06 start time -->

<!ENTITY TM06_ANALYSIS_OFFSET_CATCHUP "-00:02:00:00">
<!ENTITY TM05_ANALYSIS_OFFSET_CATCHUP "-00:02:00:00">
<!ENTITY TM04_ANALYSIS_OFFSET_CATCHUP "-00:02:00:00">
<!ENTITY TM03_ANALYSIS_OFFSET_CATCHUP "-00:01:30:00">
<!ENTITY TM02_ANALYSIS_OFFSET_CATCHUP "-00:01:00:00">
<!ENTITY TM01_ANALYSIS_OFFSET_CATCHUP "-00:00:20:00">
<!ENTITY TM00_ANALYSIS_OFFSET_CATCHUP "00:00:35:00">

<!ENTITY TM06_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "-00:01:30:00">
<!ENTITY TM05_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "-00:01:30:00">
<!ENTITY TM04_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "-00:01:30:00">
<!ENTITY TM03_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "-00:01:00:00">
<!ENTITY TM02_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "-00:00:20:00">
<!ENTITY TM01_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "00:00:35:00">
<!ENTITY TM00_ANALYSIS_MAXWAIT_OFFSET_CATCHUP "00:02:15:00">

<!-- Resource Specification for NAM sms/ecf scripts -->
<!-- *********************************************************************** -->

    <!-- GENERAL MISC. TASKS -->
<!ENTITY NAM_CLEANUP_PROC "1:ppn=1">            <!-- jobsub_arch_cleanup_${envir}_${CDATE} -->
<!ENTITY NAM_CLEANUP_RESOURCES "<walltime>00:15:00</walltime><memory>1GB</memory>">

<!ENTITY RUNNAM_SCRUB_PROC "1:ppn=1">            <!-- runnamrr${cyc}_scrub.ll -->
<!ENTITY RUNNAM_SCRUB_RESOURCES "<walltime>00:20:00</walltime><memory>800M</memory><native>-R affinity[core]</native>">

<!ENTITY POST_NODES "1:ppn=28:tpp=1">  <!-- jobsub_post -->
<!ENTITY POST_PROCS "28">
<!ENTITY POST_RESOURCES "<walltime>00:20:00</walltime><memory>28GB</memory>">

<!ENTITY PRDGEN_NODES "1:ppn=8">  <!-- jobsub_prdgen -->
<!ENTITY PRDGEN_PROCS "8">
<!ENTITY PRDGEN_RESOURCES "<walltime>00:20:00</walltime><memory>28GB</memory>">

<!ENTITY AWIPS_PROC "1:ppn=1">  <!-- jobsub_postsnd_nest -->
<!ENTITY AWIPS_RESOURCES "<walltime>00:20:00</walltime><memory>5GB</memory>">

<!ENTITY PROFILE_PROC "1:ppn=1">  <!-- jobsub_profile -->
<!ENTITY PROFILE_RESOURCES "<walltime>00:05:00</walltime><memory>8GB</memory>">

<!ENTITY POSTSND_PROC "1:ppn=1">  <!-- jobsub_postsnd_nest -->
<!ENTITY POSTSND_RESOURCES "<walltime>00:20:00</walltime><memory>8GB</memory>">

<!ENTITY PROFILE_PROC_NEST "1:ppn=1">  <!-- jobsub_profile_nest -->
<!ENTITY PROFILE_RESOURCES_NEST "<walltime>00:05:00</walltime><memory>20GB</memory>">

<!ENTITY POSTSND_PROC_NEST "1:ppn=1">  <!-- jobsub_postsnd_nest -->
<!ENTITY POSTSND_RESOURCES_NEST "<walltime>00:05:00</walltime><memory>8GB</memory>">

<!ENTITY POST_NODES_NEST "1:ppn=28:tpp=1">  <!-- jobsub_post_nest -->
<!ENTITY POST_PROCS_NEST "28">
<!ENTITY POST_RESOURCES_NEST "<walltime>00:20:00</walltime><memory>100GB</memory>">

<!ENTITY PRDGEN_NODES_NEST "1:ppn=1">  <!-- jobsub_prdgen_nest -->
<!ENTITY PRDGEN_RESOURCES_NEST "<walltime>00:20:00</walltime><memory>12GB</memory>">

<!ENTITY POST_NODES_GOESTB_PARENT "1:ppn=128:tpp=1">  <!-- jobsub_post_goestb -->
<!ENTITY POST_PROCS_GOESTB_PARENT "128">
<!ENTITY POST_RESOURCES_GOES_PARENT "<walltime>04:00:00</walltime><native>-l place=vscatter:excl</native>">

<!ENTITY POST_NODES_GOESTB_CONUS "1:ppn=128:tpp=1">  <!-- jobsub_post_goestb -->
<!ENTITY POST_PROCS_GOESTB_CONUS "128">
<!ENTITY POST_RESOURCES_GOES_CONUS "<walltime>04:00:00</walltime><native>-l place=vscatter:excl</native>">

    <!-- ********* CATCHUP CYCLE RESOURCES ********* -->

<!ENTITY CATCHUP_RUNNAM_MAIN_PROC "1:ppn=1">             <!-- runnamrr${cyc}_main.ll -->
<!ENTITY CATCHUP_RUNNAM_MAIN_RESOURCES "<walltime>00:15:00</walltime><memory>8GB</memory>">

<!ENTITY CATCHUP_RUNNAM_CHGRES_NODES "1:ppn=14">            <!-- runnamrr${cyc}_global_chgres.ll -->
<!ENTITY CATCHUP_RUNNAM_CHGRES_PROCS "14">
<!ENTITY CATCHUP_RUNNAM_CHGRES_RESOURCES "<walltime>00:10:00</walltime><memory>4GB</memory>">

<!ENTITY CATCHUP_RUNNAM_UNGRIB_NODES "1:ppn=7">           <!-- runnamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_UNGRIB_PROCS "7">
<!ENTITY CATCHUP_RUNNAM_UNGRIB_RESOURCES "<walltime>00:20:00</walltime><memory>12GB</memory>">

<!ENTITY CATCHUP_RUNNAM_METGRID_NODES "1:ppn=6">           <!-- runnamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_METGRID_PROCS "6">
<!ENTITY CATCHUP_RUNNAM_METGRID_RESOURCES "<walltime>00:20:00</walltime><memory>12GB</memory>">

<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_NODES "1:ppn=6">           <!-- runnamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_PROCS "6">
<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_RESOURCES "<walltime>00:20:00</walltime><memory>12GB</memory>">

<!ENTITY CATCHUP_RUNNAM_FORECAST_NODES "16:ppn=64:tpp=2">  <!-- runnamrr${cyc}_forecast.ll -->
<!ENTITY CATCHUP_RUNNAM_FORECAST_PROCS "1024">
<!ENTITY CATCHUP_RUNNAM_FORECAST_PPN "64">
<!ENTITY CATCHUP_RUNNAM_FORECAST_THREADS "2">

<!ENTITY CATCHUP_RUNNAM_FORECAST_RESOURCES "<walltime>00:45:00</walltime><native>-l place=vscatter:excl</native>">

<!-- Specific resources related to 00,06,12,18 free forecast component at tm06 times -->

<!ENTITY CATCHUP_RUNNAM_MAIN_FREEFORECAST_PROC "1:ppn=1">             <!-- runnamrr${cyc}_main.ll -->
<!ENTITY CATCHUP_RUNNAM_MAIN_FREEFORECAST_RESOURCES "<walltime>00:15:00</walltime><memory>8GB</memory>">

<!ENTITY CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_NODES "1:ppn=7">           <!-- runnaamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_PROCS "7">           
<!ENTITY CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_RESOURCES "<walltime>00:20:00</walltime><memory>12GB</memory>">

<!ENTITY CATCHUP_RUNNAM_METGRID_FREEFORECAST_NODES "1:ppn=15">           <!-- runnamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_METGRID_FREEFORECAST_PROCS "15">           
<!ENTITY CATCHUP_RUNNAM_METGRID_FREEFORECAST_RESOURCES "<walltime>00:20:00</walltime><memory>30GB</memory>">

<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_NODES "1:ppn=14">           <!-- runnamrr${cyc}_ungrib_boco.ll -->
<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_PROCS "14">
<!ENTITY CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_RESOURCES "<walltime>00:20:00</walltime><memory>28GB</memory>">

<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_NODES "41:ppn=63:tpp=2">  <!-- runnamrr${cyc}_forecast.ll **FOR THE CATCHUP FREE FORECAST** -->
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PROCS "2583"> 
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PPN "63"> 
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_THREADS "2"> 
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_RESOURCES "<walltime>02:45:00</walltime><native>-l place=vscatter:excl</native>">

<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_NODES "4:ppn=128:tpp=1">
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_PROCS "512">
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_PPN "128">
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_THREADS "1">
<!ENTITY CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_RESOURCES "<walltime>00:30:00</walltime><native>-l place=vscatter:excl</native>">

   <!-- RESOURCES *SPECIFIC* FOR PARENT DOMAIN -->

<!ENTITY CATCHUP_RUNNAM_PREP_NODES "1:ppn=32">            <!-- runnamrr${cyc}_prep.ll -->
<!ENTITY CATCHUP_RUNNAM_PREP_PROCS "32">            <!-- runnamrr${cyc}_prep.ll -->
<!ENTITY CATCHUP_RUNNAM_PREP_RESOURCES "<walltime>00:20:00</walltime><memory>100GB</memory>">

<!ENTITY CATCHUP_RUNNAM_PARTIALCYC_PROC "1:ppn=1">  <!-- runnamrr${cyc}_partialcyc.ll -->
<!ENTITY CATCHUP_RUNNAM_PARTIALCYC_RESOURCES "<walltime>00:05:00</walltime><memory>8GB</memory>">

<!ENTITY CATCHUP_RUNNAM_SFCUPDATE_PROC "1:ppn=1">  <!-- runnamrr${cyc}_sfcupdate.ll -->
<!ENTITY CATCHUP_RUNNAM_SFCUPDATE_RESOURCES "<walltime>00:05:00</walltime><memory>8GB</memory>">

<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NODES "9:ppn=16:tpp=8">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NTASKS "144">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_PPN "16">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_THREADS "8">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_RESOURCES "<walltime>00:30:00</walltime><native>-l place=vscatter:excl</native>">

<!ENTITY CATCHUP_RUNNAM_GEMPAK_NODES "1:ppn=6">  <!-- jobsub_gempak -->
<!ENTITY CATCHUP_RUNNAM_GEMPAK_RESOURCES "<walltime>04:00:00</walltime><memory>12GB</memory>">


   <!-- RESOURCES *SPECIFIC* FOR CONUSNEST DOMAIN -->

<!ENTITY CATCHUP_RUNNAM_PREP_NEST_NODES "1:ppn=32">            <!-- runnamrr${cyc}_prep_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_PREP_NEST_PROCS "32">        
<!ENTITY CATCHUP_RUNNAM_PREP_NEST_RESOURCES "<walltime>00:20:00</walltime><memory>100GB</memory>">

<!ENTITY CATCHUP_RUNNAM_PREP_NONCYC_NEST_NODES "1:ppn=28">            <!-- runnamrr${cyc}_prep_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_PREP_NONCYC_NEST_PROCS "28">        
<!ENTITY CATCHUP_RUNNAM_PREP_NONCYC_NEST_RESOURCES "<walltime>00:20:00</walltime><memory>100GB</memory>">

<!ENTITY CATCHUP_RUNNAM_PARTIALCYC_NEST_PROC "1:ppn=1">  <!-- runnamrr${cyc}_partialcyc_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_PARTIALCYC_NEST_RESOURCES "<walltime>00:10:00</walltime><memory>10GB</memory>">

<!ENTITY CATCHUP_RUNNAM_SFCUPDATE_NEST_PROC "1:ppn=1">  <!-- runnamrr${cyc}_sfcupdate_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_SFCUPDATE_NEST_RESOURCES "<walltime>00:05:00</walltime><memory>10GB</memory>">
 
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_NODES "11:ppn=16:tpp=8">  <!-- runnamrr${cyc}_analysis_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_NTASKS "176">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_PPN "16">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS "8">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_RESOURCES "<walltime>00:30:00</walltime><native>-l place=vscatter:excl</native>">

<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_NODES "4:ppn=32:tpp=4">  <!-- runnamrr${cyc}_analysis_nest.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_NTASKS "128">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_PPN "32">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_THREADS "4">  <!-- runnamrr${cyc}_analysis.ll -->
<!ENTITY CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_RESOURCES "<walltime>00:30:00</walltime><native>-l place=vscatter:excl</native>">

<!ENTITY CATCHUP_RUNNAM_GEMPAK_NEST_NODES "1:ppn=5">  <!-- jobsub_gempak_nest -->
<!ENTITY CATCHUP_RUNNAM_GEMPAK_NEST_RESOURCES "<walltime>04:00:00</walltime><memory>10GB</memory>">


<!-- ***********************END OF CATCHUP-SPECIFC RESOURCES********************************* -->
    
]>


<!-- ************* STARTING THE WORKFLOW  ************* -->

<workflow realtime="T" scheduler="pbspro" cyclethrottle="2" taskthrottle="100" cyclelifespan="00:23:30:00" >


  <!-- Start, Stop, Increment -->
  <cycledef group="catchup" activation_offset="-06:00:00">&STARTYEAR;&STARTMONTH;&STARTDAY;&STARTHOUR;00 &ENDYEAR;&ENDMONTH;&ENDDAY;&ENDHOUR;00 06:00:00</cycledef>


  <!--
   Very helpful example from Chris Harrop for handling the hourlies
  <cycledef group="catchup" activation_offset="-06:00:00">201504160000 201504170000 06:00:00</cycledef> 00,06,12,18
  -->

  <log>
    <cyclestr>&LOG_DIR;/workflow_@Y@m@d@H.log</cyclestr>
  </log>
  
<!-- Start the CATCHUP CYCLE -->

  <task name="main_catchup_tm06" cycledefs="catchup" maxtries="2">    

    &CATCHUP_RUNNAM_MAIN_RESOURCES;
    &RESERVATION_PRDGEN;

    <command>&JOBSnam;/JNAM_MAIN</command>
    <nodes>&CATCHUP_RUNNAM_MAIN_PROC;</nodes>
    <jobname><cyclestr>nam_main_catchup_tm06_@H</cyclestr></jobname>
    <join><cyclestr>&LOG_DIR;/nam_main_catchup_tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>DATAROOT</name>
      <value>&DATAROOT;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_main_@H</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_main_catchup_@H</cyclestr></value>
    </envar>
    <envar>
      <name>WKDIRNAME</name>
      <value><cyclestr>nam_@H_main_&ENVIR;</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
        <timedep><cyclestr offset="-00:02:20:00">@Y@m@d@H@M@S</cyclestr></timedep>
    </dependency>
  </task>

  <task name="ungrib_boco_tm06" cycledefs="catchup" maxtries="2">    

    &CATCHUP_RUNNAM_UNGRIB_RESOURCES;
    &RESERVATION_NOSHARE;

    <command>&JOBSnam;/JNAM_UNGRIB_BOCO</command>
    <nodes>&CATCHUP_RUNNAM_UNGRIB_NODES;</nodes>
    <jobname><cyclestr>nam_ungrib_catchup_tm06_@H</cyclestr></jobname>
    <join><cyclestr>&LOG_DIR;/nam_ungrib_catchup_tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_ungrib_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_ungrib_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>WKDIRNAME</name>
      <value><cyclestr>nam_@H_main_&ENVIR;</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
        <taskdep task="main_catchup_tm06"/>
    </dependency>

  </task>

  <task name="metgrid_boco_tm06" cycledefs="catchup" maxtries="2">    

    &CATCHUP_RUNNAM_METGRID_RESOURCES;
    &RESERVATION_NOSHARE;

    <command>&JOBSnam;/JNAM_METGRID_BOCO</command>
    <nodes>&CATCHUP_RUNNAM_METGRID_NODES;</nodes>
    <jobname><cyclestr>nam_metgrid_catchup_tm06_@H</cyclestr></jobname>
    <join><cyclestr>&LOG_DIR;/nam_metgrid_catchup_tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_metgrid_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_metgrid_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>WKDIRNAME</name>
      <value><cyclestr>nam_@H_main_&ENVIR;</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
        <taskdep task="ungrib_boco_tm06"/>
    </dependency>

  </task>

  <metatask name="nemsinterp_catchup_tm">
    <var name="mark">01 02 03 04 05 06</var>
    <task name="nemsinterp_tm#mark#_catchup" cycledefs="catchup" maxtries="2">

     &CATCHUP_RUNNAM_NEMSINTERP_RESOURCES;
     &RESERVATION_NOSHARE;

     <command>&JOBSnam;/JNAM_NEMSINTERP_BOCO</command>
     <nodes>&CATCHUP_RUNNAM_NEMSINTERP_NODES;</nodes>
     <jobname><cyclestr>nam_nemsinterp_catchup.tm#mark#_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_nemsinterp_catchup.tm#mark#.@Y@m@d@H.out</cyclestr></join>

      <envar>
        <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>WKDIRNAME</name>
        <value><cyclestr>nam_@H_main_&ENVIR;</cyclestr></value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_nemsinterp_boco_tm#mark#_@H</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_nemsinterp_boco_tm#mark#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm#mark#</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <dependency>
        <taskdep task="metgrid_boco_tm06"/>
      </dependency>

    </task>
  </metatask>

<!-- Done with prcoessing bocos for tm06-tm01 of CATCHUP cycle -->

<!-- COLDSTART_PREP_PARENT PARENT -->

  <task name="prep_catchup_parent" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_PREP_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_COLDSTART_PREP</command>
   <nodes>&CATCHUP_RUNNAM_PREP_NODES;</nodes>
   <jobname><cyclestr>nam_prep_catchup.tm06_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_prep_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_coldstart_prep_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>procs</name>
    <value>&CATCHUP_RUNNAM_PREP_PROCS;</value>
    </envar>
    <envar>
    <name>procspernode</name>
    <value>&CATCHUP_RUNNAM_PREP_PROCS;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_coldstart_prep_@H</cyclestr></value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="main_catchup_tm06"/>
    </dependency>

  </task>

<!-- COLDSTART_PARTIALCYC PARENT -->

  <task name="partialcyc_catchup_parent" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_PARTIALCYC_RESOURCES;
   &RESERVATION_PRDGEN;

   <command>&JOBSnam;/JNAM_COLDSTART_PARTIALCYC</command>
   <nodes>&CATCHUP_RUNNAM_PARTIALCYC_PROC;</nodes>
   <jobname><cyclestr>nam_partialcyc_catchup.tm06_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_partialcyc_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_coldstart_partialcyc_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_coldstart_partialcyc_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <and>
        <taskdep task="prep_catchup_parent"/>
        <or>
          <!-- For CATCHUP cycles we need the previous CATCHUP cycle's analysis rst files to begin -->
          <datadep age="00:00:02:00"><cyclestr offset="-06:00:00">&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.nmm_b_restart_nemsio.tm01</cyclestr></datadep>
          <!-- We can use whatever resides in nam.hold but that is much less desirable so we are willing to wait -->
          <timedep><cyclestr offset="&TM02_ANALYSIS_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
        </or>
      </and>
    </dependency>

  </task>


<!-- COLDSTART_SFCUPDATE PARENT -->

  <task name="sfcupdate_catchup_parent" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_SFCUPDATE_RESOURCES;
   &RESERVATION_PRDGEN;

   <command>&JOBSnam;/JNAM_SFCUPDATE</command>
   <nodes>&CATCHUP_RUNNAM_SFCUPDATE_PROC;</nodes>
   <jobname><cyclestr>nam_sfcupdate_catchup.tm06_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_sfcupdate_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_coldstart_sfcupdate_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_coldstart_sfcupdate_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="partialcyc_catchup_parent"/>
    </dependency>

  </task>

<!-- COLDSTART_PREP NESTS -->
  <metatask name="prep_catchup_nests">
    <var name="domain">conus alaska</var>
    <task name="prep_catchup_#domain#nest" cycledefs="catchup" maxtries="2">

     &CATCHUP_RUNNAM_PREP_NEST_RESOURCES;
     &RESERVATION_NOSHARE;

     <command>&JOBSnam;/JNAM_COLDSTART_PREP_NEST</command>
     <nodes>&CATCHUP_RUNNAM_PREP_NEST_NODES;</nodes>
     <jobname><cyclestr>nam_prep_#domain#nest_catchup.tm06_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_prep_#domain#nest_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

      <envar>
       <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>procs</name>
        <value>&CATCHUP_RUNNAM_PREP_NEST_PROCS;</value>
      </envar>
      <envar>
        <name>procspernode</name>
        <value>&CATCHUP_RUNNAM_PREP_NEST_PROCS;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_coldstart_prep_#domain#_@H</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_coldstart_prep_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm06</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <dependency>
        <taskdep task="main_catchup_tm06"/>
      </dependency>
    </task>
  </metatask>

<!-- COLDSTART_PARTIALCYC NESTS -->

  <metatask name="partialcyc_catchup_nests">
    <var name="domain">conus alaska</var>
    <task name="partialcyc_catchup_#domain#nest" cycledefs="catchup" maxtries="2">
     &CATCHUP_RUNNAM_PARTIALCYC_NEST_RESOURCES;
     &RESERVATION_PRDGEN;

     <command>&JOBSnam;/JNAM_COLDSTART_PARTIALCYC_NEST</command>
     <nodes>&CATCHUP_RUNNAM_PARTIALCYC_NEST_PROC;</nodes>
     <jobname><cyclestr>nam_partialcyc_#domain#nest_catchup.tm06_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_partialcyc_#domain#nest_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

      <envar>
       <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_coldstart_partialcyc_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_coldstart_partialcyc_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>tmmark</name>
        <value>tm06</value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <dependency>
        <and>
          <taskdep task="prep_catchup_#domain#nest"/>
          <or>
            <!-- For CATCHUP cycles we need the previous CATCHUP cycle's analysis rst files to begin -->                                                           
            <datadep age="00:00:02:00"><cyclestr offset="-06:00:00">&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.nmm_b_restart_#domain#nest_nemsio.tm01</cyclestr></datadep>
            <!-- We can use whatever resides in nam.hold but that is much less desirable so we are willing to wait -->
            <timedep><cyclestr offset="&TM02_ANALYSIS_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
          </or>
        </and>
      </dependency>
    </task>
  </metatask>

<!-- COLDSTART_SFCUPDATE NESTS -->
  <metatask name="sfcupdate_catchup_nests">
    <var name="domain">conus alaska</var>
    <task name="sfcupdate_catchup_#domain#nest" cycledefs="catchup" maxtries="2">

      &CATCHUP_RUNNAM_SFCUPDATE_NEST_RESOURCES;
      &RESERVATION_PRDGEN;

      <command>&JOBSnam;/JNAM_SFCUPDATE_NEST</command>
      <nodes>&CATCHUP_RUNNAM_SFCUPDATE_NEST_PROC;</nodes>
      <jobname><cyclestr>nam_sfcupdate_#domain#nest_catchup.tm06_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_sfcupdate_#domain#nest_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_coldstart_sfcupdate_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_coldstart_sfcupdate_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm06</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
        <taskdep task="partialcyc_catchup_#domain#nest"/>
      </dependency>
    </task>
  </metatask>


<!-- BEGIN TM06 ANALYSIS-FORECAST STEPS -->

<!-- ANALYSIS PARENT TM06 -->

  <task name="analysis_catchup_parent_tm06" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_ANALYSIS_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_ANALYSIS</command>
   <nodes>&CATCHUP_RUNNAM_ANALYSIS_NODES;</nodes>
   <jobname><cyclestr>nam_analysis_catchup.tm06_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_analysis_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NTASKS;</value>
    </envar>
    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_PPN;</value>
    </envar>
    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>
    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>
    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>jlogfile</name>
    <value>&JLOGFILE;</value>
    </envar>
    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_analysis_tm06_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_analysis_tm06_@H</cyclestr></value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm06</value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <and>
        <taskdep task="sfcupdate_catchup_parent"/>
        <timedep><cyclestr offset="&TM06_ANALYSIS_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
        <or>
          <datadep age="00:00:03:00">&COM_PREPBUFR;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm06</cyclestr></datadep>
          <timedep><cyclestr offset="&TM06_ANALYSIS_MAXWAIT_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
        </or>
      </and>
    </dependency>

  </task>

<!-- ANALYSIS NESTS TM06 -->

  <metatask name="analysis_catchup_nests_tm06">
    <var name="domain">conus alaska</var>
    <task name="analysis_catchup_#domain#nest_tm06" cycledefs="catchup" maxtries="2">

      &CATCHUP_RUNNAM_ANALYSIS_NEST_RESOURCES;
      &RESERVATION_NOSHARE;

      <command>&JOBSnam;/JNAM_ANALYSIS_NEST</command>
      <nodes>&CATCHUP_RUNNAM_ANALYSIS_NEST_NODES;</nodes>
      <jobname><cyclestr>nam_analysis_#domain#nest_catchup.tm06_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_analysis_#domain#nest_catchup.tm06.@Y@m@d@H.out</cyclestr></join>

      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_analysis_#domain#.tm06_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_analysis_#domain#.tm06_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>
    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>
    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>
    
    <envar>
    <name>jlogfile</name>
    <value>&JLOGFILE;</value>
    </envar>
    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>
      <envar>
        <name>ntasks</name>
        <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_NTASKS;</value>
      </envar>
      <envar>
        <name>ppn</name>
        <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_PPN;</value>
      </envar>
      <envar>
        <name>threads</name>
        <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
      <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm06</value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <dependency>
        <and>
          <taskdep task="sfcupdate_catchup_#domain#nest"/>
          <timedep><cyclestr offset="&TM06_ANALYSIS_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
          <or>
            <datadep age="00:00:03:00">&COM_PREPBUFR;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm06</cyclestr></datadep>
            <timedep><cyclestr offset="&TM06_ANALYSIS_MAXWAIT_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
          </or>
        </and>
      </dependency>
    </task>
  </metatask>


<!-- Handle the remaining bits of the CATCHUP FCST/Analysis steps as a metatask -->
<!-- TM06 fcst - TM01 analysis -->

  <metatask name="catchup_fcst_analysis_set">

      <var name="mark">06 05 04 03 02</var>
      <var name="next_mark">05 04 03 02 01</var>
      <var name="analysis_offset">&TM05_ANALYSIS_OFFSET_CATCHUP; &TM04_ANALYSIS_OFFSET_CATCHUP; &TM03_ANALYSIS_OFFSET_CATCHUP; &TM02_ANALYSIS_OFFSET_CATCHUP; &TM01_ANALYSIS_OFFSET_CATCHUP;</var>
      <var name="analysis_maxwait_offset">&TM05_ANALYSIS_MAXWAIT_OFFSET_CATCHUP; &TM04_ANALYSIS_MAXWAIT_OFFSET_CATCHUP; &TM03_ANALYSIS_MAXWAIT_OFFSET_CATCHUP; &TM02_ANALYSIS_MAXWAIT_OFFSET_CATCHUP; &TM01_ANALYSIS_MAXWAIT_OFFSET_CATCHUP;</var>


      <task name="forecast_catchup_tm#mark#" cycledefs="catchup" maxtries="2">
        &CATCHUP_RUNNAM_FORECAST_RESOURCES;
        &RESERVATION_NOSHARE;
        <command>&JOBSnam;/JNAM_FORECAST</command>
        <nodes>&CATCHUP_RUNNAM_FORECAST_NODES;</nodes>
        <jobname><cyclestr>nam_forecast_catchup.tm#mark#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_forecast_catchup.tm#mark#.@Y@m@d@H.out</cyclestr></join>
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_catchup_forecast_tm#mark#_@H</cyclestr></value> 
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_catchup_forecast_tm#mark#_@H</cyclestr></value> 
        </envar>
        <envar>
          <name>nam_ver</name>
         <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>
        <envar>
         <name>OMP_STACKSIZE</name>
         <value>1G</value>
         </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>
        <envar>
          <name>threads</name>
          <value>&CATCHUP_RUNNAM_FORECAST_THREADS;</value>
        </envar>
        <envar>
          <name>OMP_NUM_THREADS</name>
          <value>&CATCHUP_RUNNAM_FORECAST_THREADS;</value>
        </envar>
        <envar>
          <name>ntasks</name>
          <value>&CATCHUP_RUNNAM_FORECAST_PROCS;</value>
        </envar>

        <envar>
          <name>ppn</name>
          <value>&CATCHUP_RUNNAM_FORECAST_PPN;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>RUNTYPE</name>
          <value>CATCHUP</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm#mark#</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <dependency>
          <and>
            <metataskdep metatask="nemsinterp_catchup_tm"/>
            <taskdep task="analysis_catchup_parent_tm#mark#"/>
            <metataskdep metatask="analysis_catchup_nests_tm#mark#"/>
          </and>
        </dependency>
      </task>

      <task name="analysis_catchup_parent_tm#next_mark#" cycledefs="catchup" maxtries="2">

        &CATCHUP_RUNNAM_ANALYSIS_RESOURCES;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_ANALYSIS</command>
        <nodes>&CATCHUP_RUNNAM_ANALYSIS_NODES;</nodes>
        <jobname><cyclestr>nam_analysis_catchup.tm#next_mark#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_analysis_catchup.tm#next_mark#.@Y@m@d@H.out</cyclestr></join>

        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_catchup_analysis_tm#next_mark#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_catchup_analysis_tm#next_mark#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm#next_mark#</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NTASKS;</value>
    </envar>
    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_PPN;</value>
    </envar>
    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>

    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>

    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>

    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
          <and>
            <taskdep task="forecast_catchup_tm#mark#"/>
            <timedep><cyclestr offset="#analysis_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
            <or>
              <datadep age="00:00:03:00">&COM_PREPBUFR;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm#next_mark#</cyclestr></datadep>
              <timedep><cyclestr offset="#analysis_maxwait_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
            </or>
          </and>
        </dependency>
      </task>

      <metatask name="analysis_catchup_nests_tm#next_mark#">
        <var name="domain">conus alaska</var>    
        <task name="analysis_catchup_#domain#nest_tm#next_mark#" cycledefs="catchup" maxtries="2">

          &CATCHUP_RUNNAM_ANALYSIS_NEST_RESOURCES;
          &RESERVATION_NOSHARE;

          <command>&JOBSnam;/JNAM_ANALYSIS_NEST</command>
          <nodes>&CATCHUP_RUNNAM_ANALYSIS_NEST_NODES;</nodes>
          <jobname><cyclestr>nam_analysis_#domain#nest_catchup.tm#next_mark#_@H</cyclestr></jobname>
          <join><cyclestr>&LOG_DIR;/nam_analysis_#domain#nest_catchup.tm#next_mark#.@Y@m@d@H.out</cyclestr></join>

          <envar>
            <name>cyc</name>
            <value><cyclestr>@H</cyclestr></value>
          </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
          <envar>
            <name>envir</name>
            <value>&ENVIR;</value>
          </envar>
          <envar>
            <name>job</name>
            <value><cyclestr>nam_catchup_analysis_#domain#.tm#next_mark#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>jobid</name>
            <value><cyclestr>jnam_catchup_analysis_#domain#.tm#next_mark#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>nam_ver</name>
            <value>&NAM_VER;</value>
          </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
          <envar>
            <name>NWROOT</name>
            <value>&NWROOT;</value>
          </envar>
          <envar>
            <name>PACKAGEROOT</name>
            <value>&PACKAGEROOT;</value>
          </envar>
          <envar>
            <name>COMDATEROOT</name>
            <value>&COMDATEROOT;</value>
          </envar>
          <envar>
            <name>HOMEjobs</name>
            <value>&HOMEjobs;</value>
          </envar>
          <envar>
            <name>tmmark</name>
            <value>tm#next_mark#</value>
          </envar>
          <envar>
            <name>domain</name>
            <value>#domain#</value>
          </envar>
          <envar>
            <name>PDY</name>
            <value><cyclestr>@Y@m@d</cyclestr></value>
          </envar>

    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_NTASKS;</value>
    </envar>
    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_PPN;</value>
    </envar>
    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>
    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>
    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>
    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>
          <dependency>
            <and>
              <taskdep task="forecast_catchup_tm#mark#"/>
              <timedep><cyclestr offset="#analysis_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
              <or>
                <datadep age="00:00:03:00">&COM_PREPBUFR;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm#next_mark#</cyclestr></datadep>
                <timedep><cyclestr offset="#analysis_maxwait_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
              </or>
            </and>
          </dependency>
        </task>
      </metatask>
    </metatask>


  <metatask name="catchup_fcst_analysis_tm00_set">

      <var name="mark">01</var>
      <var name="next_mark">00</var>
      <var name="analysis_offset">&TM00_ANALYSIS_OFFSET_CATCHUP;</var>
      <var name="analysis_maxwait_offset">&TM00_ANALYSIS_MAXWAIT_OFFSET_CATCHUP;</var>

      <task name="forecast_catchup_tm#mark#" cycledefs="catchup" maxtries="2">
        &CATCHUP_RUNNAM_FORECAST_RESOURCES;
        &RESERVATION_NOSHARE;
        <command>&JOBSnam;/JNAM_FORECAST</command>
        <nodes>&CATCHUP_RUNNAM_FORECAST_NODES;</nodes>
        <jobname><cyclestr>nam_forecast_catchup.tm#mark#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_forecast_catchup.tm#mark#.@Y@m@d@H.out</cyclestr></join>
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>


        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>

        <envar>
         <name>OMP_STACKSIZE</name>
         <value>1G</value>
         </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>

        <envar>
          <name>threads</name>
          <value>&CATCHUP_RUNNAM_FORECAST_THREADS;</value>
        </envar>

        <envar>
          <name>OMP_NUM_THREADS</name>
          <value>&CATCHUP_RUNNAM_FORECAST_THREADS;</value>
        </envar>

        <envar>
          <name>ntasks</name>
          <value>&CATCHUP_RUNNAM_FORECAST_PROCS;</value>
        </envar>

        <envar>
          <name>ppn</name>
          <value>&CATCHUP_RUNNAM_FORECAST_PPN;</value>
        </envar>

        <envar>
          <name>job</name>
          <value><cyclestr>nam_catchup_forecast.tm#mark#_@H</cyclestr></value> 
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_catchup_forecast.tm#mark#_@H</cyclestr></value> 
        </envar>
        <envar>
          <name>RUNTYPE</name>
          <value>CATCHUP</value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm#mark#</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
        <dependency>
          <and>
            <metataskdep metatask="nemsinterp_catchup_tm"/>
            <taskdep task="analysis_catchup_parent_tm#mark#"/>
            <metataskdep metatask="analysis_catchup_nests_tm#mark#"/>
          </and>
        </dependency>
      </task>

      <task name="analysis_catchup_parent_tm#next_mark#" cycledefs="catchup" maxtries="2">

        &CATCHUP_RUNNAM_ANALYSIS_RESOURCES;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_ANALYSIS</command>
        <nodes>&CATCHUP_RUNNAM_ANALYSIS_NODES;</nodes>
        <jobname><cyclestr>nam_analysis_catchup.tm#next_mark#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_analysis_catchup.tm#next_mark#.@Y@m@d@H.out</cyclestr></join>

        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_analysis_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_analysis_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm#next_mark#</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NTASKS;</value>
    </envar>

    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_PPN;</value>
    </envar>

    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>

    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_THREADS;</value>
    </envar>

    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>

    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>

    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>

    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>

    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
          <and>
            <taskdep task="main_catchup_tm00"/>
            <taskdep task="forecast_catchup_tm#mark#"/>
            <timedep><cyclestr offset="#analysis_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
            <or>
              <datadep age="00:00:03:00">&COM_PREPBUFR_TM00;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm#next_mark#</cyclestr></datadep>
              <timedep><cyclestr offset="#analysis_maxwait_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
            </or>
          </and>
        </dependency>
      </task>

      <metatask name="analysis_catchup_nests_tm#next_mark#">
        <var name="domain">conus alaska</var>    
        <task name="analysis_catchup_#domain#nest_tm#next_mark#" cycledefs="catchup" maxtries="2">

          &CATCHUP_RUNNAM_ANALYSIS_NEST_RESOURCES;
          &RESERVATION_NOSHARE;

          <command>&JOBSnam;/JNAM_ANALYSIS_NEST</command>
          <nodes>&CATCHUP_RUNNAM_ANALYSIS_NEST_NODES;</nodes>
          <jobname><cyclestr>nam_analysis_#domain#nest_catchup.tm#next_mark#_@H</cyclestr></jobname>
          <join><cyclestr>&LOG_DIR;/nam_analysis_#domain#nest_catchup.tm#next_mark#.@Y@m@d@H.out</cyclestr></join>

          <envar>
            <name>cyc</name>
            <value><cyclestr>@H</cyclestr></value>
          </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
          <envar>
            <name>envir</name>
            <value>&ENVIR;</value>
          </envar>
          <envar>
            <name>job</name>
            <value><cyclestr>nam_analysis_#domain#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>jobid</name>
            <value><cyclestr>jnam_analysis_#domain#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>tmmark</name>
            <value>tm#next_mark#</value>
          </envar>
          <envar>
            <name>nam_ver</name>
            <value>&NAM_VER;</value>
          </envar>
          <envar>
            <name>NWROOT</name>
            <value>&NWROOT;</value>
          </envar>
          <envar>
            <name>PACKAGEROOT</name>
            <value>&PACKAGEROOT;</value>
          </envar>
    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_NTASKS;</value>
    </envar>

    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_PPN;</value>
    </envar>

    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
    </envar>

    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_THREADS;</value>
    </envar>

    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>

    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>

    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>

    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>
    
          <envar>
            <name>COMDATEROOT</name>
            <value>&COMDATEROOT;</value>
          </envar>
          <envar>
            <name>HOMEjobs</name>
            <value>&HOMEjobs;</value>
          </envar>
          <envar>
            <name>domain</name>
            <value>#domain#</value>
          </envar>
          <envar>
            <name>PDY</name>
            <value><cyclestr>@Y@m@d</cyclestr></value>
          </envar>
          <dependency>
            <and>
              <taskdep task="main_catchup_tm00"/>
              <taskdep task="forecast_catchup_tm#mark#"/>
              <timedep><cyclestr offset="#analysis_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
              <or>
                <datadep age="00:00:03:00">&COM_PREPBUFR_TM00;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm#next_mark#</cyclestr></datadep>
                <timedep><cyclestr offset="#analysis_maxwait_offset#">@Y@m@d@H@M@S</cyclestr></timedep>
              </or>
            </and>
          </dependency>
        </task>
      </metatask>
    </metatask>

<!-- Post and Prdgen Tasks for the TM06-TM01 part of the CATCHUP cycle -->

  <!-- PARENT: Post steps - this is for CATCHUP type TM06-TM01 cycles only -->
  <metatask>
    <var name="mark">06 05 04 03 02 01</var>
      <metatask> 
        <var name="fcsthour">00 01</var>
          <task name="post_tm#mark#_#fcsthour#" cycledefs="catchup" maxtries="2">

           &POST_RESOURCES;
           &RESERVATION_NOSHARE;

            <command>&JOBSnam;/JNAM_POST</command>
            <nodes>&POST_NODES;</nodes>
            <jobname><cyclestr>nam_post_tm#mark#_f#fcsthour#_@H</cyclestr></jobname>
            <join><cyclestr>&LOG_DIR;/nam_post.f#fcsthour#.tm#mark#.@Y@m@d@H.out</cyclestr></join>    
            <envar>
              <name>cyc</name>
              <value><cyclestr>@H</cyclestr></value>
            </envar>
            <envar>
              <name>envir</name>
              <value>&ENVIR;</value>
            </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
            <envar>
              <name>PDY</name>
              <value><cyclestr>@Y@m@d</cyclestr></value>
            </envar>
            <envar>
              <name>job</name>
              <value><cyclestr>nam_catchup_post_tm#mark#_f#fcsthour#_@H</cyclestr></value>
            </envar>
            <envar>
              <name>jobid</name>
              <value><cyclestr>jnam_catchup_post_tm#mark#_f#fcsthour#_@H</cyclestr></value>
            </envar>
            <envar>
              <name>nam_ver</name>
            <value>&NAM_VER;</value>
            </envar>
            <envar>
              <name>procs</name>
              <value>&POST_PROCS;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS;</value>
            </envar>
            <envar>
              <name>NWROOT</name>
              <value>&NWROOT;</value>
            </envar>
            <envar>
              <name>PACKAGEROOT</name>
              <value>&PACKAGEROOT;</value>
            </envar>
            <envar>
              <name>COMDATEROOT</name>
              <value>&COMDATEROOT;</value>
            </envar>
            <envar>
              <name>HOMEjobs</name>
              <value>&HOMEjobs;</value>
            </envar>
            <envar>
              <name>tmmark</name>
              <value>tm#mark#</value>
            </envar>
            <envar>
              <name>post_times</name>
              <value>#fcsthour#</value>
            </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      
            <dependency>
	    <and>
               <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm#mark#_&ENVIR;/fcstdone.01.00#fcsthour#h_00m_00.00s</datadep>
	       <or>
	       <datadep age="00:00:02:00"><cyclestr>&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.input_domain_01_nemsio.anl.tm#mark# </cyclestr></datadep>
	       <datadep age="00:00:02:00"><cyclestr>&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.nmm_b_restart_nemsio_anl.tm#mark# </cyclestr></datadep>
	       </or>
           </and>
            </dependency>
          </task>
      </metatask>
  </metatask>


  <!-- PRDGEN FOR PARENT -->
  <!-- PARENT: Prdgen steps - this is for CATCHUP TM06-TM01 type cycles only -->
  <metatask name="prdgen_catchup_tm06-tm01">
    <var name="mark">06 05 04 03 02 01</var>
      <metatask mode="serial"> 
        <var name="fcsthour">00 01</var>
          <task name="prdgen_tm#mark#_#fcsthour#" cycledefs="catchup" maxtries="2">
            &PRDGEN_RESOURCES;
            &RESERVATION_PRDGEN;
            <command>&JOBSnam;/JNAM_PRDGEN</command>
            <nodes>&PRDGEN_NODES;</nodes>
            <jobname><cyclestr>nam_prdgen_tm#mark#_f#fcsthour#_@H</cyclestr></jobname>
            <join><cyclestr>&LOG_DIR;/nam_prdgen.f#fcsthour#.tm#mark#.@Y@m@d@H.out</cyclestr></join>    
            <envar>
              <name>cyc</name>
              <value><cyclestr>@H</cyclestr></value>
            </envar>
            <envar>
              <name>envir</name>
              <value>&ENVIR;</value>
            </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
            <envar>
              <name>PDY</name>
              <value><cyclestr>@Y@m@d</cyclestr></value>
            </envar>
            <envar>
              <name>job</name>
              <value><cyclestr>nam_catchup_prdgen_tm#mark#_f#fcsthour#_@H</cyclestr></value>
            </envar>
            <envar>
              <name>jobid</name>
              <value><cyclestr>jnam_catchup_prdgen_tm#mark#_f#fcsthour#_@H</cyclestr></value>
            </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
            <envar>
              <name>nam_ver</name>
            <value>&NAM_VER;</value>
            </envar>
            <envar>
              <name>NWROOT</name>
              <value>&NWROOT;</value>
            </envar>
            <envar>
              <name>PACKAGEROOT</name>
              <value>&PACKAGEROOT;</value>
            </envar>
            <envar>
              <name>COMDATEROOT</name>
              <value>&COMDATEROOT;</value>
            </envar>
            <envar>
              <name>HOMEjobs</name>
              <value>&HOMEjobs;</value>
            </envar>
            <envar>
              <name>tmmark</name>
              <value>tm#mark#</value>
            </envar>
            <envar>
              <name>fcsthrs</name>
              <value>#fcsthour#</value>
            </envar>
            <dependency>
              <taskdep task="post_tm#mark#_#fcsthour#"/>
            </dependency>
          </task>
      </metatask>
  </metatask>

  <!-- NESTS : Post steps - this is for CATCHUP TM06-TM01 type cycles only -->
  <metatask name="post_nests_catchup_tm06-tm01">
    <var name="domain">conus alaska</var>
    <var name="numdom">02 03</var>
    <metatask name="post_#domain#_catchup_tm06-tm01">
      <var name="mark">06 05 04 03 02 01</var>
        <metatask> 
          <var name="fcsthour">00 01</var>
            <task name="post_#domain#_tm#mark#_#fcsthour#" cycledefs="catchup" maxtries="2">
              &POST_RESOURCES_NEST;
              &RESERVATION_NOSHARE;
             <command>&JOBSnam;/JNAM_POST_NEST</command>
             <nodes>&POST_NODES_NEST;</nodes>
             <jobname><cyclestr>nam_post_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></jobname>
             <join><cyclestr>&LOG_DIR;/nam_post_#domain#.f#fcsthour#.tm#mark#.@Y@m@d@H.out</cyclestr></join>    
             <envar>
               <name>cyc</name>
               <value><cyclestr>@H</cyclestr></value>
             </envar>
             <envar>
               <name>envir</name>
               <value>&ENVIR;</value>
             </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
             <envar>
               <name>PDY</name>
               <value><cyclestr>@Y@m@d</cyclestr></value>
             </envar>
             <envar>
               <name>job</name>
               <value><cyclestr>nam_catchup_post_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></value>
             </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
            <envar>
              <name>procs</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
             <envar>
               <name>jobid</name>
               <value><cyclestr>jnam_catchup_post_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></value>
             </envar>
             <envar>
               <name>nam_ver</name>
             <value>&NAM_VER;</value>
             </envar>
             <envar>
               <name>NWROOT</name>
               <value>&NWROOT;</value>
             </envar>
             <envar>
               <name>PACKAGEROOT</name>
               <value>&PACKAGEROOT;</value>
             </envar>
             <envar>
               <name>COMDATEROOT</name>
               <value>&COMDATEROOT;</value>
             </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
             <envar>
               <name>HOMEjobs</name>
               <value>&HOMEjobs;</value>
             </envar>
             <envar>
               <name>tmmark</name>
               <value>tm#mark#</value>
             </envar>
             <envar>
               <name>post_times</name>
               <value>#fcsthour#</value>
             </envar>
             <envar>
               <name>domain</name>
               <value>#domain#</value>
             </envar>
             <dependency>
	     <and>
                 <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm#mark#_&ENVIR;/fcstdone.#numdom#.00#fcsthour#h_00m_00.00s</datadep>
	         <or>
		 <datadep age="00:00:02:00"><cyclestr>&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.input_domain_#domain#nest_nemsio.anl.tm#mark#</cyclestr></datadep>
		 <datadep age="00:00:02:00"><cyclestr>&GESIN;/&RUN;.@Y@m@d/nam.t@Hz.nmm_b_restart_#domain#nest_nemsio_anl.tm#mark#</cyclestr></datadep>
		 </or>
		 </and>
             </dependency>    
           </task>
        </metatask>
    </metatask>
  </metatask>

  <!-- PRDGEN FOR NESTS -->
  <!-- NEST: PRDGEN steps - this is for CATCHUP TM06-TM01 type cycles only -->
  <metatask name="prdgen_nests_catchup_tm06-tm01">
    <var name="domain">conus alaska</var>
    <metatask name="prdgen_#domain#_catchup_tm06-tm01">
      <var name="mark">06 05 04 03 02 01</var>
      <metatask mode="serial">
        <var name="fcsthour">00 01</var>
        <task name="prdgen_#domain#_tm#mark#_#fcsthour#" cycledefs="catchup" maxtries="2">
          &PRDGEN_RESOURCES_NEST;
          &RESERVATION_PRDGEN;
          <command>&JOBSnam;/JNAM_PRDGEN_NEST</command>
          <nodes>&PRDGEN_NODES_NEST;</nodes>
          <jobname><cyclestr>nam_prdgen_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></jobname>
          <join><cyclestr>&LOG_DIR;/nam_prdgen_#domain#.f#fcsthour#.tm#mark#.@Y@m@d@H.out</cyclestr></join>    
          <envar>
            <name>cyc</name>
            <value><cyclestr>@H</cyclestr></value>
          </envar>
          <envar>
            <name>envir</name>
            <value>&ENVIR;</value>
          </envar>
          <envar>
            <name>PDY</name>
            <value><cyclestr>@Y@m@d</cyclestr></value>
          </envar>
          <envar>
            <name>job</name>
            <value><cyclestr>nam_catchup_prdgen_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>jobid</name>
            <value><cyclestr>jnam_catchup_prdgen_#domain#_tm#mark#_f#fcsthour#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>nam_ver</name>
          <value>&NAM_VER;</value>
          </envar>
          <envar>
            <name>NWROOT</name>
            <value>&NWROOT;</value>
          </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
          <envar>
            <name>PACKAGEROOT</name>
            <value>&PACKAGEROOT;</value>
          </envar>
          <envar>
            <name>COMDATEROOT</name>
            <value>&COMDATEROOT;</value>
          </envar>
          <envar>
            <name>HOMEjobs</name>
            <value>&HOMEjobs;</value>
          </envar>
          <envar>
            <name>tmmark</name>
            <value>tm#mark#</value>
          </envar>
          <envar>
            <name>fcsthrs</name>
            <value>#fcsthour#</value>
          </envar>
          <envar>
            <name>domain</name>
            <value>#domain#</value>
          </envar>
          <dependency>
            <taskdep task="post_#domain#_tm#mark#_#fcsthour#"/>
          </dependency>
        </task>
      </metatask>
    </metatask>
  </metatask>

<!-- POST TM01 RESTART FILE FOR NON-CYCLED NESTS PREP JOB -->

  <task name="posttm01" cycledefs="catchup" maxtries="2">

   &POST_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_POSTTM01</command>
   <nodes>&POST_NODES;</nodes>
   <jobname><cyclestr>nam_posttm01_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_posttm01.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_catchup_posttm01_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_catchup_posttm01_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
            <envar>
              <name>procs</name>
              <value>&POST_PROCS;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS;</value>
            </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm01</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="forecast_catchup_tm01"/>
    </dependency>

  </task>

<!-- COLDSTART_PREP FOR NON-CYCLED NESTS -->
  <metatask name="prep_catchup_noncycnests">
    <var name="domain">firewx hawaii prico</var>
    <task name="prep_catchup_#domain#nest" cycledefs="catchup" maxtries="2">

     &CATCHUP_RUNNAM_PREP_NONCYC_NEST_RESOURCES;
     &RESERVATION_NOSHARE;

     <command>&JOBSnam;/JNAM_COLDSTART_PREP_NEST</command>
     <nodes>&CATCHUP_RUNNAM_PREP_NONCYC_NEST_NODES;</nodes>
     <jobname><cyclestr>nam_prep_#domain#nest_catchup.tm01_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_prep_#domain#nest_catchup.tm01.@Y@m@d@H.out</cyclestr></join>

      <envar>
       <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_npsguess_#domain#_tm01_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_npsguess_#domain#_tm01_@H</cyclestr></value>
      </envar>
      <!--- need resources here -->
      <envar>
      <name>procs</name>
      <value>&CATCHUP_RUNNAM_PREP_NONCYC_NEST_PROCS;</value>
      </envar>
      <envar>
      <name>procspernode</name>
      <value>&CATCHUP_RUNNAM_PREP_NONCYC_NEST_PROCS;</value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm01</value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <dependency>
        <taskdep task="posttm01"/>
      </dependency>
    </task>
  </metatask>

<!-- COLDSTART_PARTIALCYC FOR NON-CYCLED NESTS -->

  <metatask name="partialcyc_catchup_noncycnests">
    <var name="domain">firewx hawaii prico</var>
    <task name="partialcyc_catchup_#domain#nest" cycledefs="catchup" maxtries="2">
     &CATCHUP_RUNNAM_PARTIALCYC_NEST_RESOURCES;
     &RESERVATION_PRDGEN;

     <command>&JOBSnam;/JNAM_COLDSTART_PARTIALCYC_NEST</command>
     <nodes>&CATCHUP_RUNNAM_PARTIALCYC_NEST_PROC;</nodes>
     <jobname><cyclestr>nam_partialcyc_#domain#nest_catchup.tm01_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_partialcyc_#domain#nest_catchup.tm01.@Y@m@d@H.out</cyclestr></join>

      <envar>
       <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_nestiniguess_#domain#nest_tm01_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_nestiniguess_#domain#nest_tm01_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>tmmark</name>
        <value>tm01</value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <dependency>
         <taskdep task="prep_catchup_#domain#nest"/>
      </dependency>
    </task>
  </metatask>

<!-- COLDSTART_SFCUPDATE NESTS FOR NON-CYCLED NESTS-->
  <metatask name="sfcupdate_catchup_noncycnests">
    <var name="domain">firewx hawaii prico</var>
    <task name="sfcupdate_catchup_#domain#nest" cycledefs="catchup" maxtries="2">

      &CATCHUP_RUNNAM_SFCUPDATE_NEST_RESOURCES;
      &RESERVATION_PRDGEN;

      <command>&JOBSnam;/JNAM_SFCUPDATE_NEST</command>
      <nodes>&CATCHUP_RUNNAM_SFCUPDATE_NEST_PROC;</nodes>
      <jobname><cyclestr>nam_sfcupdate_#domain#nest_catchup.tm01_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_sfcupdate_#domain#nest_catchup.tm01.@Y@m@d@H.out</cyclestr></join>

      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_catchup_nestsfcupdate_#domain#_tm01_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_catchup_nestsfcupdate_#domain#_tm01_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm01</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>

      <dependency>
        <taskdep task="partialcyc_catchup_#domain#nest"/>
      </dependency>
    </task>
  </metatask>

<!-- NOW ENTERING FREE FORECAST PART OF CATCHUP CYCLE! -->

  <task name="main_catchup_tm00" cycledefs="catchup" maxtries="2">    

    &CATCHUP_RUNNAM_MAIN_FREEFORECAST_RESOURCES;
    &RESERVATION_PRDGEN;

    <command>&JOBSnam;/JNAM_MAIN</command>
    <nodes>&CATCHUP_RUNNAM_MAIN_FREEFORECAST_PROC;</nodes>
    <jobname><cyclestr>nam_main_catchup_tm00_@H</cyclestr></jobname>
    <join><cyclestr>&LOG_DIR;/nam_main_catchup_tm00.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_main_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_main_@H</cyclestr></value>
    </envar>
    <envar>
      <name>WKDIRNAME</name>
      <value><cyclestr>nam_@H_main_&ENVIR;</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
      <and>
        <taskdep task="forecast_catchup_tm01"/>
        <metataskdep metatask="sfcupdate_catchup_noncycnests"/>
	<timedep><cyclestr offset="00:01:05:00">@Y@m@d@H@M@S</cyclestr></timedep>
      </and>
    </dependency>

  </task>

<!-- Make bocos for free forecast -->

  <task name="ungrib_boco_tm00_catchup" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_UNGRIB_BOCO</command>
   <nodes>&CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_NODES;</nodes>
   <jobname><cyclestr>nam_ungrib_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_ungrib_catchup.tm00.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_ungrib_boco_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>procs</name>
    <value>&CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_PROCS;</value>
    </envar>
    <envar>
    <name>procspernode</name>
    <value>&CATCHUP_RUNNAM_UNGRIB_FREEFORECAST_PROCS;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_ungrib_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="main_catchup_tm00"/>      
    </dependency>

  </task>

  <task name="metgrid_boco_tm00_catchup" cycledefs="catchup" maxtries="2">

   &CATCHUP_RUNNAM_METGRID_FREEFORECAST_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_METGRID_BOCO</command>
   <nodes>&CATCHUP_RUNNAM_METGRID_FREEFORECAST_NODES;</nodes>
   <jobname><cyclestr>nam_metgrid_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_metgrid_catchup.tm00.@Y@m@d@H.out</cyclestr></join>

    <envar>
      <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_metgrid_boco_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_metgrid_boco_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="ungrib_boco_tm00_catchup"/>
    </dependency>
  </task>

  <metatask name="nemsinterp_boco_tm00_catchup">
    <var name="inum">1 2 3 4 5 6 7</var>
    <task name="nemsinterp_#inum#_catchup" cycledefs="catchup" maxtries="2">

     &CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_RESOURCES;
     &RESERVATION_NOSHARE;

     <command>&JOBSnam;/JNAM_NEMSINTERP_BOCO</command>
     <nodes>&CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_NODES;</nodes>
     <jobname><cyclestr>nam_nemsinterp_catchup.#inum#_@H</cyclestr></jobname>
     <join><cyclestr>&LOG_DIR;/nam_nemsinterp_catchup.#inum#.@Y@m@d@H.out</cyclestr></join>

      <envar>
        <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_nemsinterp_boco_#numk#_@H</cyclestr></value>
      </envar>
      <envar> 
      <name>procs</name>
      <value>&CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_PROCS;</value>
      </envar>
      <envar> 
      <name>procspernode</name>
      <value>&CATCHUP_RUNNAM_NEMSINTERP_FREEFORECAST_PROCS;</value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_nemsinterp_boco_#numk#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>inum</name>
        <value>#inum#</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <dependency>
        <taskdep task="metgrid_boco_tm00_catchup"/>
      </dependency>
    </task>
  </metatask>

<!-- ANALYSIS PARENT TM00: Already taken care of in meta task loop -->

<!-- ANALYSIS FOR CYCLED NESTS AT TM00: Already taken care of in meta task loop -->

<!-- ANALYSIS FOR NON-CYCLED NESTS AT TM00 -->

     <metatask name="analysis_catchup_noncycnests_tm00">
        <var name="domain">firewx hawaii prico</var>    
        <task name="analysis_catchup_#domain#nest_tm00" cycledefs="catchup" maxtries="2">

          &CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_RESOURCES;
          &RESERVATION_NOSHARE;

          <command>&JOBSnam;/JNAM_ANALYSIS_NEST</command>
          <nodes>&CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_NODES;</nodes>
          <jobname><cyclestr>nam_analysis_#domain#nest_catchup.tm00_@H</cyclestr></jobname>
          <join><cyclestr>&LOG_DIR;/nam_analysis_#domain#nest_catchup.tm00.@Y@m@d@H.out</cyclestr></join>

          <envar>
            <name>cyc</name>
            <value><cyclestr>@H</cyclestr></value>
          </envar>
          <envar>
            <name>envir</name>
            <value>&ENVIR;</value>
          </envar>
          <envar>
            <name>job</name>
            <value><cyclestr>nam_analysis_#domain#_@H</cyclestr></value>
          </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>
    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_NTASKS;</value>
    </envar>
    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_PPN;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_PLACES</name>
    <value>cores</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>

    <envar>
    <name>FI_OFI_RXM_SAR_LIMIT</name>
    <value>3145728</value>
    </envar>
    <envar>
    <name>MPICH_COLL_OPT_OFF</name>
    <value>1</value>
    </envar>

    <envar>
    <name>COM_PREPBUFR</name>
    <value>&COM_PREPBUFR;</value>
    </envar>

    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_ANALYSIS_NEST_SMALL_THREADS;</value>
    </envar>
          <envar>
            <name>jobid</name>
            <value><cyclestr>jnam_analysis_#domain#_@H</cyclestr></value>
          </envar>
          <envar>
            <name>nam_ver</name>
            <value>&NAM_VER;</value>
          </envar>
          <envar>
            <name>NWROOT</name>
            <value>&NWROOT;</value>
          </envar>
          <envar>
            <name>PACKAGEROOT</name>
            <value>&PACKAGEROOT;</value>
          </envar>
          <envar>
          <name>COMDATEROOT</name>
            <value>&COMDATEROOT;</value>
          </envar>
          <envar>
            <name>HOMEjobs</name>
            <value>&HOMEjobs;</value>
          </envar>
          <envar>
            <name>tmmark</name>
            <value>tm00</value>
          </envar>
          <envar>
            <name>domain</name>
            <value>#domain#</value>
          </envar>
          <envar>
            <name>PDY</name>
            <value><cyclestr>@Y@m@d</cyclestr></value>
          </envar>
          <dependency>
            <and>
              <taskdep task="main_catchup_tm00"/>
              <timedep><cyclestr offset="&TM00_ANALYSIS_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
              <metataskdep metatask="sfcupdate_catchup_noncycnests"/>
              <or>
                <datadep age="00:00:03:00">&COM_PREPBUFR_TM00;/<cyclestr>nam.@Y@m@d/nam.t@Hz.prepbufr.tm00</cyclestr></datadep>
                <timedep><cyclestr offset="&TM00_ANALYSIS_MAXWAIT_OFFSET_CATCHUP;">@Y@m@d@H@M@S</cyclestr></timedep>
              </or>
            </and>
          </dependency>
        </task>
      </metatask>

<!-- FORECAST TM00 -->

  <task name="forecast_catchup_tm00" cycledefs="catchup" maxtries="3">

   &CATCHUP_RUNNAM_FREEFORECAST_RESOURCES;
   &RESERVATION_NOSHARE;

   <command>&JOBSnam;/JNAM_FORECAST</command>
   <nodes>&CATCHUP_RUNNAM_FREEFORECAST_NODES;</nodes>
   <jobname><cyclestr>nam_forecast_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_forecast_catchup.tm00.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>

    <envar>
    <name>ntasks</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_PROCS;</value>
    </envar>
    <envar>
    <name>ppn</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_PPN;</value>
    </envar>
    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_STACKSIZE</name>
    <value>1G</value>
    </envar>

    <envar>
    <name>OMP_PROC_BIND</name>
    <value>true</value>
    </envar>

    <envar>
      <name>job</name>
      <value><cyclestr>nam_forecast_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_forecast_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <and>
        <metataskdep metatask="nemsinterp_boco_tm00_catchup"/>
        <taskdep task="analysis_catchup_parent_tm00"/>
        <metataskdep metatask="analysis_catchup_nests_tm00"/>
        <metataskdep metatask="analysis_catchup_noncycnests_tm00"/>
      </and>
    </dependency>
  </task>


  <!-- START OPTIONAL CATCHUP EXTENSION. DO NOT REMOVE THIS COMMENT LINE -->
  <task name="forecast_catchup_parentext_tm00" cycledefs="catchup" maxtries="2">
   &CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_RESOURCES;
   &RESERVATION_CATCHUP_FORECAST;
   <command>&JOBSnam;/JNAM_FORECAST_PARENTEXT</command>
   <nodes>&CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_NODES;</nodes>
   <jobname><cyclestr>nam_forecast_parentext_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_forecast_parentext_catchup.tm00.@Y@m@d@H.out</cyclestr></join>
    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_forecast_parentext_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_forecast_parentext_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <!-- need resource information here -->
    <envar>
      <name>ntasks</name>
      <value>&CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_PROCS;</value>
    </envar>
    
    <envar>
      <name>ppn</name>
      <value>&CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_PPN;</value>
    </envar>

        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>
        <envar>
         <name>OMP_STACKSIZE</name>
         <value>1G</value>
         </envar>

        <envar>
          <name>OMP_PROC_BIND</name>
          <value>true</value>
        </envar>

    <envar>
    <name>threads</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_THREADS;</value>
    </envar>
    <envar>
    <name>OMP_NUM_THREADS</name>
    <value>&CATCHUP_RUNNAM_FREEFORECAST_PARENTEXT_THREADS;</value>
    </envar>

    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    
    <dependency>
      <taskdep task="forecast_catchup_tm00"/>
    </dependency>
  </task>

  <!-- END OPTIONAL CATCHUP EXTENSION. DO NOT REMOVE THIS COMMENT LINE -->

<!-- BEGIN ALL POST RELATED TASKS FOR CATCHUP AND HOURLY TYPE FREE FORECASTS -->


  <!-- Put in all post tasks here for free forecast (HOURLY+CATCHUP TM00s) (postx2, prdgenx2, goespost, profilepost, sndpost) -->
  <!-- PARENT: Post steps - this is for CATCHUP type cycles only -->

  <!-- Do first 6 fhrs here since we want to make sure the rst file exists to copy into hold -->
  <metatask>
    <var name="fcsthour">00 01 02 03 04 05 06</var>
    <task name="post_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

      &POST_RESOURCES;
      &RESERVATION_NOSHARE;

      <command>&JOBSnam;/JNAM_POST</command>
      <nodes>&POST_NODES;</nodes>
      <jobname><cyclestr>nam_post_tm00_f#fcsthour#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_post.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    

            <envar>
              <name>procs</name>
              <value>&POST_PROCS;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS;</value>
            </envar>
      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>

      <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>

      <envar>
        <name>job</name>
        <value><cyclestr>nam_post_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_post_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>post_times</name>
        <value>#fcsthour#</value>
      </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
          <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.01.00#fcsthour#h_00m_00.00s</datadep>
      </dependency>

    </task>
  </metatask>

  <!-- Put in all post tasks here for free forecast (HOURLY+CATCHUP TM00s) (postx2, prdgenx2, goespost, profilepost, sndpost) -->
  <!-- PARENT: Post steps - this is for CATCHUP -->
  <metatask>
    <var name="fcsthour">&CATCHUP_PARENT_FHR07_to_FMAX;</var>
    <task name="post_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

      &POST_RESOURCES;
      &RESERVATION_NOSHARE;

      <command>&JOBSnam;/JNAM_POST</command>
      <nodes>&POST_NODES;</nodes>
      <jobname><cyclestr>nam_post_tm00_f#fcsthour#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_post.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
         <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_post_f#fcsthour#_@H</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_post_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>post_times</name>
        <value>#fcsthour#</value>
      </envar>
      
            <envar>
              <name>procs</name>
              <value>&POST_PROCS;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS;</value>
            </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
          <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.01.00#fcsthour#h_00m_00.00s</datadep>
      </dependency>

    </task>
  </metatask>

  <!-- PRDGEN FOR PARENT -->
  <!-- PARENT: Prdgen steps - this is for CATCHUP type cycles only -->
  <!-- Run in serial mode, meaning each successive task may not run until the previous one -->
  <!-- has completed (not necessary if running in devhigh/devmax)-->
  <metatask name="prdgen_catchup">
    <var name="fcsthour">&CATCHUP_PARENT_PRDGEN_TIMES;</var>
    <task name="prdgen_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">
      &PRDGEN_RESOURCES;
      &RESERVATION_PRDGEN;
      <command>&JOBSnam;/JNAM_PRDGEN</command>
      <nodes>&PRDGEN_NODES;</nodes>
      <jobname><cyclestr>nam_prdgen_tm00_f#fcsthour#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_prdgen.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_prdgen_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_prdgen_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>fcsthrs</name>
        <value>#fcsthour#</value>
      </envar>

      <envar>
      <name>GRB2INDEX</name>
      <value>/apps/ops/prod/libs/intel/19.1.3.304/grib_util/1.2.2/bin/grb2index</value>
      </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
        <taskdep task="post_catchup_tm00_#fcsthour#"/>
      </dependency>
    </task>
  </metatask>

  <!-- AWIPS FOR PARENT -->
  <!-- PARENT: Prdgen steps - this is for CATCHUP type cycles only -->
  <!-- Run in serial mode, meaning each successive task may not run until the previous one -->
  <!-- has completed (not necessary if running in devhigh/devmax)-->
  <metatask name="awips_catchup">
    <var name="fcsthour">&CATCHUP_PARENT_AWIPS_TIMES;</var>
    <task name="awips_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">
      &AWIPS_RESOURCES;
      &RESERVATION_AWIPS;
      <command>&JOBSnam;/JNAM_AWIPS</command>
      <nodes>&AWIPS_PROC;</nodes>
      <jobname><cyclestr>nam_awips_tm00_f#fcsthour#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_awips.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_awips_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_awips_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>fcsthrs</name>
        <value>#fcsthour#</value>
      </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
        <taskdep task="prdgen_catchup_tm00_#fcsthour#"/>
      </dependency>
    </task>
  </metatask>

<!-- PROFILE PARENT -->
<!-- PARENT: Profile bufr sounding post steps - this is for CATCHUPtype cycles -->
  <metatask name="profile_catchup">
    <var name="fcsthour">&CATCHUP_PARENT_FHR_LIST;</var>
    <task name="profile_catchup_#fcsthour#" cycledefs="catchup" maxtries="2">

      &PROFILE_RESOURCES;
      &RESERVATION_PRDGEN;

      <command>&JOBSnam;/JNAM_PROFILE</command>
      <nodes>&PROFILE_PROC;</nodes>
      <jobname><cyclestr>nam_profile_tm00_f#fcsthour#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_profile.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join> 
      <envar>
        <name>cyc</name>
        <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_profile_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_profile_f#fcsthour#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>
      <envar>
        <name>fhr</name>
        <value>#fcsthour#</value>
      </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <dependency>
          <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.01.00#fcsthour#h_00m_00.00s</datadep>
      </dependency>

    </task>
  </metatask>

<!-- PARENT: Last piece of the bufr sounding post steps - this is for CATCHUP type cycles only -->
  <task name="postsnd_catchup" cycledefs="catchup" maxtries="2">

   &POSTSND_RESOURCES;
   &RESERVATION_PRDGEN;

   <command>&JOBSnam;/JNAM_POSTSND</command>
   <nodes>&POSTSND_PROC;</nodes>
   <jobname><cyclestr>nam_postsnd_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_postsnd.tm00.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_postsnd_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_postsnd_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <!-- Start the postsnd only when ALL profile jobs have completed successfully -->
    <dependency>
      <metataskdep metatask="profile_catchup"/>
    </dependency>
  </task>

  <task name="fbwind_catchup" cycledefs="catchup" maxtries="2">

   &AWIPS_RESOURCES;
   &RESERVATION_AWIPS;

   <command>&JOBSnam;/JNAM_FBWIND</command>
   <nodes>&AWIPS_PROC;</nodes>
   <jobname><cyclestr>nam_fbwind_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_fbwind.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_fbwind_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_fbwind_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <dependency>
      <and>
        <taskdep task="prdgen_catchup_tm00_06"/>
        <taskdep task="prdgen_catchup_tm00_12"/>
        <taskdep task="prdgen_catchup_tm00_24"/>
      </and>
    </dependency>
  </task>

  <task name="bulls_catchup" cycledefs="catchup" maxtries="2">

   &AWIPS_RESOURCES;
   &RESERVATION_AWIPS;

   <command>&JOBSnam;/JNAM_BULLS</command>
   <nodes>&AWIPS_PROC;</nodes>
   <jobname><cyclestr>nam_bulls_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_bulls.@Y@m@d@H.out</cyclestr></join>

    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_bulls_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_bulls_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <dependency>
        <metataskdep metatask="prdgen_catchup"/>
    </dependency>
  </task>

  <!-- START OPTIONAL GEMPAK FOR CATCHUP PARENT. DO NOT REMOVE THIS COMMENT LINE -->
  <task name="nam_gempak_catchup" cycledefs="catchup" maxtries="2">
   &CATCHUP_RUNNAM_GEMPAK_RESOURCES;
   &RESERVATION_NOSHARE;
   <command>&JOBSnam;/JNAM_GEMPAK</command>
   <nodes>&CATCHUP_RUNNAM_GEMPAK_NODES;</nodes>
   <jobname><cyclestr>nam_gempak_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_gempak_catchup.tm00.@Y@m@d@H.out</cyclestr></join>
    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_gempak_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_gempak_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
      <taskdep task="post_catchup_tm00_00"/>   
    </dependency>
  </task>

  <task name="nam_gempak_meta_catchup" cycledefs="catchup" maxtries="2">
   &CATCHUP_RUNNAM_GEMPAK_RESOURCES;
   &RESERVATION_NOSHARE;
   <command>&JOBSnam;/JNAM_GEMPAK_META</command>
   <nodes>&CATCHUP_RUNNAM_GEMPAK_NODES;</nodes>
   <jobname><cyclestr>nam_gempak_meta_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_gempak_meta_catchup.tm00.@Y@m@d@H.out</cyclestr></join>
    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_gempak_meta_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_gempak_meta_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>
    <dependency>
      <taskdep task="nam_gempak_catchup"/>   
    </dependency>
  </task>

  <!-- END OPTIONAL GEMPAK FOR CATCHUP PARENT. DO NOT REMOVE THIS COMMENT LINE -->

<!--

************************************************************************************************
BEGIN POST PIECES FOR THE NEST PARTS OF THE FREE FORECAST
*************************************************************************************************

-->


  <!-- NESTS: Post steps - this is for CATCHUP type cycles only -->
  <!-- Do first 6 fhrs here since we want to make sure the rst file exists to copy into hold -->

  <metatask>
    <var name="domain">conus alaska hawaii prico firewx</var>
    <var name="numdom">02 03 04 05 06</var>
    <metatask>
      <var name="fcsthour">00 01 02 03 04 05 06</var>
      <task name="post_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

        &POST_RESOURCES_NEST;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_POST_NEST</command>
        <nodes>&POST_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_post_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_post_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
            <envar>
              <name>procs</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>post_times</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
            <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.#numdom#.00#fcsthour#h_00m_00.00s</datadep>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- NEST: Post steps - this is for CATCHUP type cycles only -->
  <metatask>
    <var name="domain">conus alaska hawaii prico</var>
    <var name="numdom">02 03 04 05</var>
    <metatask>
      <var name="fcsthour">&CATCHUP_NEST_FHR07_to_FMAX;</var>
      <task name="post_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

        &POST_RESOURCES_NEST;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_POST_NEST</command>
        <nodes>&POST_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_post_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_post_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
            <envar>
              <name>procs</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>post_times</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
              <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.#numdom#.00#fcsthour#h_00m_00.00s</datadep>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- PRDGEN FOR NESTS -->
  <!-- PRDGEN steps - this is for CATCHUP type cycles only -->
  <metatask name="prdgen_nests_catchup">
    <var name="domain">conus alaska hawaii prico</var>
    <metatask name="prdgen_#domain#_catchup">
      <var name="fcsthour">&CATCHUP_NEST_PRDGEN_TIMES;</var>
      <task name="prdgen_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">
        &PRDGEN_RESOURCES_NEST;
        &RESERVATION_PRDGEN;
        <command>&JOBSnam;/JNAM_PRDGEN_NEST</command>
        <nodes>&PRDGEN_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_prdgen_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_prdgen_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_prdgen_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_prdgen_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>fcsthrs</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
          <taskdep task="post_#domain#_catchup_tm00_#fcsthour#"/>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- FIREWX NEST: Post steps - this is for CATCHUP type cycles only -->
  <metatask>
    <var name="domain">firewx</var>
    <var name="numdom">06</var>
    <metatask>
      <var name="fcsthour">&CATCHUP_NEST_FHR07_to_FMAX_Firewx;</var>
      <task name="post_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

        &POST_RESOURCES_NEST;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_POST_NEST</command>
        <nodes>&POST_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_post_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_post_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>post_times</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
   

        <dependency>
          <taskdep task="post_#domain#_catchup_tm00_#fcsthour#"/>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- FIREWX NEST: Post steps - this is for CATCHUP type cycles only -->
  <metatask>
    <var name="domain">firewx</var>
    <var name="numdom">06</var>
    <metatask>
      <var name="fcsthour">&CATCHUP_NEST_FHR07_to_FMAX_Firewx;</var>
      <task name="post_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">

        &POST_RESOURCES_NEST;
        &RESERVATION_NOSHARE;

        <command>&JOBSnam;/JNAM_POST_NEST</command>
        <nodes>&POST_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_post_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_post_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_post_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>

            <envar>
              <name>procs</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>
            <envar>
              <name>procspernode</name>
              <value>&POST_PROCS_NEST;</value>
            </envar>

        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>post_times</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
           <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.#numdom#.00#fcsthour#h_00m_00.00s</datadep>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- PRDGEN FOR Firewx NESTS -->
  <!-- PRDGEN steps - this is for CATCHUP type cycles only -->
  <metatask name="prdgen_nests_catchup_firewx">
    <var name="domain">firewx</var>
    <metatask name="prdgen_#domain#_catchup">
      <var name="fcsthour">&CATCHUP_NEST_PRDGEN_TIMES_Firewx;</var>
      <task name="prdgen_#domain#_catchup_tm00_#fcsthour#" cycledefs="catchup" maxtries="2">
        &PRDGEN_RESOURCES_NEST;
        &RESERVATION_PRDGEN;
        <command>&JOBSnam;/JNAM_PRDGEN_NEST</command>
        <nodes>&PRDGEN_NODES_NEST;</nodes>
        <jobname><cyclestr>nam_prdgen_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_prdgen_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join>    
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_prdgen_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_prdgen_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>fcsthrs</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
          <taskdep task="post_#domain#_catchup_tm00_#fcsthour#"/>
        </dependency>
      </task>
    </metatask>
  </metatask>

  <!-- PROFILE NEST -->
  <!-- Profile bufr sounding post steps - this is for CATCHUP type cycles -->
  <metatask name="profile_nests_catchup">
    <var name="domain">conus alaska hawaii prico</var>
    <var name="numdom">02 03 04 05</var>
    <metatask name="profile_#domain#_catchup">
      <var name="fcsthour">&CATCHUP_NEST_FHR_LIST;</var>
      <task name="profile_#domain#_catchup_#fcsthour#" cycledefs="catchup" maxtries="2">

        &PROFILE_RESOURCES_NEST;
        &RESERVATION_PRDGEN;

        <command>&JOBSnam;/JNAM_PROFILE_NEST</command>
        <nodes>&PROFILE_PROC_NEST;</nodes>
        <jobname><cyclestr>nam_profile_#domain#_tm00_f#fcsthour#_@H</cyclestr></jobname>
        <join><cyclestr>&LOG_DIR;/nam_profile_#domain#.f#fcsthour#.tm00.@Y@m@d@H.out</cyclestr></join> 
        <envar>
          <name>cyc</name>
          <value><cyclestr>@H</cyclestr></value>
        </envar>
        <envar>
          <name>envir</name>
          <value>&ENVIR;</value>
        </envar>
        <envar>
          <name>PDY</name>
          <value><cyclestr>@Y@m@d</cyclestr></value>
        </envar>
        <envar>
          <name>job</name>
          <value><cyclestr>nam_profile_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
        <envar>
          <name>jobid</name>
          <value><cyclestr>jnam_profile_#domain#_f#fcsthour#_@H</cyclestr></value>
        </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
        <envar>
          <name>nam_ver</name>
          <value>&NAM_VER;</value>
        </envar>
        <envar>
          <name>NWROOT</name>
          <value>&NWROOT;</value>
        </envar>
        <envar>
          <name>PACKAGEROOT</name>
          <value>&PACKAGEROOT;</value>
        </envar>
        <envar>
          <name>COMDATEROOT</name>
          <value>&COMDATEROOT;</value>
        </envar>
        <envar>
          <name>HOMEjobs</name>
          <value>&HOMEjobs;</value>
        </envar>
        <envar>
          <name>tmmark</name>
          <value>tm00</value>
        </envar>
        <envar>
          <name>fhr</name>
          <value>#fcsthour#</value>
        </envar>
        <envar>
          <name>domain</name>
          <value>#domain#</value>
        </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>
    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

        <dependency>
            <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.#numdom#.00#fcsthour#h_00m_00.00s</datadep>
        </dependency>
      </task>
    </metatask>
  </metatask>


  <!-- NESTS: Last piece of the bufr sounding post steps - this is for CATCHUP type cycles only -->
  <metatask name="postsnd_nests_catchup">
    <var name="domain">conus alaska hawaii prico</var>
    <task name="postsnd_#domain#_catchup" cycledefs="catchup" maxtries="2">

      &POSTSND_RESOURCES_NEST;
      &RESERVATION_PRDGEN;

      <command>&JOBSnam;/JNAM_POSTSND_NEST</command>
      <nodes>&POSTSND_PROC_NEST;</nodes>
      <jobname><cyclestr>nam_postsnd_#domain#_@H</cyclestr></jobname>
      <join><cyclestr>&LOG_DIR;/nam_postsnd_#domain#.tm00.@Y@m@d@H.out</cyclestr></join>

      <envar>
       <name>cyc</name>
       <value><cyclestr>@H</cyclestr></value>
      </envar>
      <envar>
        <name>envir</name>
        <value>&ENVIR;</value>
      </envar>
      <envar>
        <name>PDY</name>
        <value><cyclestr>@Y@m@d</cyclestr></value>
      </envar>
      <envar>
        <name>job</name>
        <value><cyclestr>nam_postsnd_#domain#_@H</cyclestr></value>
      </envar>
      <envar>
        <name>jobid</name>
        <value><cyclestr>jnam_postsnd_#domain#_@H</cyclestr></value>
      </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
      <envar>
        <name>nam_ver</name>
        <value>&NAM_VER;</value>
      </envar>
      <envar>
        <name>NWROOT</name>
        <value>&NWROOT;</value>
      </envar>
      <envar>
        <name>PACKAGEROOT</name>
        <value>&PACKAGEROOT;</value>
      </envar>
      <envar>
        <name>COMDATEROOT</name>
        <value>&COMDATEROOT;</value>
      </envar>
      <envar>
        <name>HOMEjobs</name>
        <value>&HOMEjobs;</value>
      </envar>
      <envar>
        <name>domain</name>
        <value>#domain#</value>
      </envar>
      <envar>
        <name>tmmark</name>
        <value>tm00</value>
      </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

      <!-- Start the postsnd only when ALL profile_#domain# jobs have completed successfully -->
      <dependency>
        <metataskdep metatask="profile_#domain#_catchup"/>
      </dependency>
    </task>
  </metatask>

  <!-- START OPTIONAL GEMPAK FOR CATCHUP NESTS. DO NOT REMOVE THIS COMMENT LINE -->
  <task name="nam_gempak_nest_catchup" cycledefs="catchup" maxtries="2">
   &CATCHUP_RUNNAM_GEMPAK_NEST_RESOURCES;
   &RESERVATION_NOSHARE;
   <command>&JOBSnam;/JNAM_GEMPAK_NEST</command>
   <nodes>&CATCHUP_RUNNAM_GEMPAK_NEST_NODES;</nodes>
   <jobname><cyclestr>nam_gempak_nest_catchup.tm00_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_gempak_nest_catchup.tm00.@Y@m@d@H.out</cyclestr></join>
    <envar>
      <name>cyc</name>
      <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
     <name>job</name>
      <value><cyclestr>nam_gempak_nest_@H</cyclestr></value>
    </envar>
    <envar>
     <name>jobid</name>
      <value><cyclestr>jnam_gempak_nest_@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
       <taskdep task="post_conus_catchup_tm00_00"/>
    </dependency>
  </task>
  <!-- END OPTIONAL GEMPAK FOR CATCHUP NESTS. DO NOT REMOVE THIS COMMENT LINE -->


  <!-- START OPTIONAL GOES POST FOR CATCHUP. DO NOT REMOVE THIS COMMENT LINE -->
  <!-- GOES POST FOR PARENT -->
  <task name="nam_post_goestb_tm00" cycledefs="catchup" maxtries="2">
   &POST_RESOURCES_GOES_PARENT;
   &RESERVATION_NOSHARE;
   <command>&JOBSnam;/JNAM_POST_GOESTB</command>
   <nodes>&POST_NODES_GOESTB_PARENT;</nodes>
   <jobname><cyclestr>nam_post_goestb_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_post_goestb.@Y@m@d@H.out</cyclestr></join>
    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_post_goestb_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_post_goestb_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>

    <envar>
    <name>procs</name>
    <value>&POST_PROCS_GOESTB_PARENT;</value>
    </envar>

    <envar>
    <name>procspernode</name>
    <value>&POST_PROCS_GOESTB_PARENT;</value>
    </envar>


    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
      <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.01.0000h_00m_00.00s</datadep>
    </dependency>
  </task>

<!-- GOES POST FOR CONUS NEST -->

  <task name="nam_post_goestb_conus_tm00" cycledefs="catchup" maxtries="2">
   &POST_RESOURCES_GOES_CONUS;
   &RESERVATION_NOSHARE;
   <command>&JOBSnam;/JNAM_POST_GOESTB_NEST</command>
   <nodes>&POST_NODES_GOESTB_CONUS;</nodes>
   <jobname><cyclestr>nam_post_goestb_conusnest_@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_post_goestb_conusnest.@Y@m@d@H.out</cyclestr></join>
    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
    <name>procs</name>
    <value>&POST_PROCS_GOESTB_CONUS;</value>
    </envar>
    <envar>
    <name>procspernode</name>
    <value>&POST_PROCS_GOESTB_CONUS;</value>
    </envar>
    
    <envar>
      <name>job</name>
      <value><cyclestr>nam_post_goestb_conus_@H</cyclestr></value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_post_goestb_conus_@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>domain</name>
      <value>conus</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
      <datadep age="00:00:00:10">&DATAROOT;/<cyclestr>nam_@H</cyclestr>_tm00_&ENVIR;/fcstdone.02.0000h_00m_00.00s</datadep>
    </dependency>
  </task>

<!-- CLEANUP -->

  <task name="nam_catchup_cleanup" cycledefs="catchup" maxtries="2">
   &NAM_CLEANUP_RESOURCES;
   &RESERVATION;
   <command>&JOBSnam;/JNAM_CLEANUP</command>
   <nodes>&NAM_CLEANUP_PROC;</nodes>
   <jobname><cyclestr>nam_cleanup_&ENVIR;_@Y@m@d@H</cyclestr></jobname>
   <join><cyclestr>&LOG_DIR;/nam_cleanup_&ENVIR;.@Y@m@d@H.out</cyclestr></join>
    <envar>
     <name>cyc</name>
     <value><cyclestr>@H</cyclestr></value>
    </envar>
    <envar>
      <name>envir</name>
      <value>&ENVIR;</value>
    </envar>
    <envar>
      <name>job</name>
      <value><cyclestr>nam_cleanup_&ENVIR;_@Y@m@d@H</cyclestr></value>
    </envar>
    <envar>
    <name>HOMEnam</name>
    <value>&HOMEnam;</value>
    </envar>
    <envar>
      <name>jobid</name>
      <value><cyclestr>jnam_cleanup_&ENVIR;_@Y@m@d@H</cyclestr></value>
    </envar>
    <envar>
      <name>nam_ver</name>
      <value>&NAM_VER;</value>
    </envar>
    <envar>
      <name>NWROOT</name>
      <value>&NWROOT;</value>
    </envar>
    <envar>
      <name>PACKAGEROOT</name>
      <value>&PACKAGEROOT;</value>
    </envar>
    <envar>
      <name>COMDATEROOT</name>
      <value>&COMDATEROOT;</value>
    </envar>
    <envar>
      <name>HOMEjobs</name>
      <value>&HOMEjobs;</value>
    </envar>
    <envar>
      <name>tmmark</name>
      <value>tm00</value>
    </envar>
    <envar>
      <name>PDY</name>
      <value><cyclestr>@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMIN</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <envar>
    <name>COMOUT</name>
    <value><cyclestr>&COMOUTbase;/nam.@Y@m@d</cyclestr></value>
    </envar>

    <dependency>
       <and>
        <metataskdep metatask="postsnd_nests_catchup"/>
        <taskdep task="postsnd_catchup"/>
        <taskdep task="nam_post_goestb_tm00"/>
        <taskdep task="nam_post_goestb_conus_tm00"/>
        <metataskdep metatask="prdgen_catchup"/>
        <metataskdep metatask="prdgen_nests_catchup"/>
        <metataskdep metatask="prdgen_nests_catchup_firewx"/>
       </and>
    </dependency>
  </task>

  <!-- END OPTIONAL GOES POST FOR CATCHUP. DO NOT REMOVE THIS COMMENT LINE -->

</workflow>
